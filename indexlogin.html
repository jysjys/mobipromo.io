<!DOCTYPE>
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
<link rel="icon" href="assets/images/title.png" type="image/png" sizes="16x16">
<title>Login</title>
<meta name="keywords" content="" />
<meta name="description" content="" />
<link rel="stylesheet" href="assets/css/login.css" />
<style>
	.login_warn {
		display: none;
		line-height: 15px;
		padding-left: 10px;
	}
</style>
<body>

<div class="login-container">
	<h1>欢迎登陆Mobipromo</h1>

	<div class="connect">
		<p>www.mobipromo.io</p>
	</div>
		<div>
			<input type="text" name="phone" class="phone" placeholder="手机号/邮箱" autocomplete="off"/>
		</div>
		<div>
			<input type="password" name="password" class="password" placeholder="密码" oncontextmenu="return false" onpaste="return false" />
		</div>
		<div>
			<input type="text" class="login_warn warn" value="用户名或密码不正确！" disabled='disabled'>
		</div>
		<button id="submit" type="submit" style="margin-left: 0;">登 录</button>
	<a href="register.html" style='display: block;'>
		<button type="button" class="register-tis">还没有账号？</button>
	</a>
</div>

<script src="assets/js/jquery.min.js"></script>
<!-- <script src="assets/js/common.js"></script> -->
<!--背景图片自动更换-->
<script src="assets/js/supersized.3.2.7.min.js"></script>
<script src="assets/js/supersized-init.js"></script>
<!--表单验证-->
<!-- <script src="assets/js/jquery.validate.min.js?var1.14.0"></script> -->
<script>
// let epid = '';
// for(let i=0; i<6; i++) {
//     epid += Math.floor(Math.random() * 9);
// }
function addCookie(name,value, exdays){
	var d = new Date();
	d.setTime(d.getTime() + (exdays*24*60*60*1000));
	var expires = "expires="+d.toUTCString();
    var name = name;
    var value = escape(value);
    document.cookie = name + "=" + value + "; " + expires;
}
$("#submit").click(function () {
	var datalogin = {
		username: $("input[name='phone']").val().trim(),
		password: $("input[name='password']").val().trim(),
		grant_type: "password"
	}
	console.log(datalogin)
	$.ajax({
	   headers: {
	          Accept: "application/json; charset=utf-8",
	    	  Authorization:"Basic cHJvbW9zZXJ2ZXI6ZTYxOTcyMDViYTZmOWM2"
	      },
	   type: 'POST',
	   url: '/promo/token',
	   data: datalogin,
	   contentType: "application/x-www-form-urlencoded",
		success: function (data) {
    		addCookie('Authorization', data.access_token, 1);
			window.location.href='./presale.html'
		},
		error: function (data) {
			$(".login_warn").css({
				'display': 'inline-block'
			})
		}
	});
});
</script>
</body>
</html>